# Test file for Amble LSP - Room definitions and references

room test-room-one {
    name "Test Room One"
    desc "This is the first test room."
    visited true
    exit north -> test-room-four
    exit south -> test-room-three
}

room test-room-two {
    name "Test Room Two"
    desc "This is the second test room."
    exit south -> test-room-one
    exit east -> test-room-four
}

room test-room-three {
    name "Test Room Three"
    desc "This is the third test room."
    exit north -> test-room-one
}

room test-room-four {
    name "Test Room Four"
    desc "This is the fourth test room."
    exit west -> test-room-two
    exit east ->
}

# Test trigger with room references
trigger "test-trigger" when always {
    if has item test_item {
        do add flag test-flag
    }
}

trigger "another-test" when talk to npc test_npc {
    do show ""
}

item test_item {
    name "Item Name"
    desc "Item description..."
    portable true
    location nowhere "noplace"
}

npc test_npc {
    name "NPC Name"
    desc "Npc description..."
    location nowhere "noplace"
}

room another-test-room {
    name "Room Name"
    desc "Room Description"
    visited false
    exit "through the door" -> library
    overlay if item present test_item {
        text "test_item present"
    }
    overlay if npc test_npc here {
        normal "test_npc is doing nothing"
    }
    overlay if flag some-flag {
        set "some flag is set"
        unset "some flag is unset"
    }
}

trigger "Testing Autocomplete"
when enter room treasure-room {
    if any(has flag test-flag, has item test-item-valid) {
        do show "something"
    }
    if any(with npc test_npc, npc in state test-npc-valid happy, npc has item test-npc-valid test-item-valid, player in room test-room-four
    , container test-item-valid has item lebowski_rug) {
        do set npc active test_npc
        do replace item test-item-valid with invitation
        do replace drop item test-item-valid with test-item-valid
        do add flag another-test-flag
        do reset flag another-test-flag
        do add seq flag another-sequence limit 3
        do advance flag another-sequence
        do remove flag another-test-flag
        do spawn item test-item-valid into room test-room-three

    }
}

trigger "Autocomplete When Test"
when use item test-item-valid on item test_item interaction burn {
    do show "something"
}
